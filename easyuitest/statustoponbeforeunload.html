<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>onbeforeunload Demo</title>
	<link rel="stylesheet" type="text/css" href="../src/easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="../src/easyui/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="../src/easyui/demo/demo.css">
	<script type="text/javascript" src="../src/easyui/jquery.min.js"></script>
	<script type="text/javascript" src="../src/easyui/jquery.easyui.min.js"></script>
</head>
<body>
<h2>Alert Messager</h2>
<p>Click on each button to display different alert message box.</p>
<a href="../ierightclick.html">跳转到其他页面</a>

<button>点击按钮</button>
<div style="margin:20px 0;">
	<div style="margin:20px 0;">
		<a href="#" class="easyui-linkbutton" onclick="alert1()">Alert</a>
		<a href="#" class="easyui-linkbutton" onclick="confirm1();">Confirm</a>
	</div>
</div>
<script>
	//修改easyui源码加入一个独有的全局变量，只有当点击的是easyui的弹出框才能拿到这个变量，控制onbeforeunload的开关,
	//easyui源码中已经将status设为false
	window.onbeforeunload=function(event){
    event = event || window.event;
    event.returnValue = '确定离开此页面';
    console.log(event);
    setTimeout(function () {
      //用户点击留在此页执行的操作
      window.location.href='../ierightclick.html'
    },5000)
	};
	//确认离开此页，点击确认时触发的事件
	window.onunload=function(){
	  //用户确定离开此页后需要执行的代码
		alert('您已经离开此页')
	};
	function alert1(){
		$.messager.alert('My Title','Here is a message!');
	}
	function confirm1() {
      $.messager.confirm('My Title', 'Are you confirm this?', function (r) {
          if (r) {
              alert('confirmed: ' + r);
          }
      });
	}
</script>
</body>
</html>